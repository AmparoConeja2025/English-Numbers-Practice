<!DOCTYPE html>    
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√°ctica de N√∫meros en Ingl√©s</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .learning-gradient {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        .practice-gradient {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
        }
        .level-gradient {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
            .version-indicator {
            position: absolute;
            bottom: 0px;
            right: 10px;
            background: none;
            color: rgba(255, 255, 255, 0.85);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 8px;
            font-family: 'Courier New', monospace;
            backdrop-filter: none;
            border: none;
            z-index: 10;
        }
        
        /* üì± PREVENT ACCIDENTAL ZOOM ON ALL BUTTONS */
        button {
            touch-action: manipulation;
        }
        .number-display {
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .word-display {
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            box-shadow: 0 4px 15px 0 rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(102, 126, 234, 0.6);
        }
        .btn-secondary {
            background: linear-gradient(45deg, #f093fb, #f5576c);
            box-shadow: 0 4px 15px 0 rgba(240, 147, 251, 0.4);
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(240, 147, 251, 0.6);
        }
        .btn-success {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            box-shadow: 0 4px 15px 0 rgba(79, 172, 254, 0.4);
            transition: all 0.3s ease;
            touch-action: manipulation;
            margin-bottom: 16px;
        }
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(79, 172, 254, 0.6);
        }
        .btn-level {
            background: linear-gradient(45deg, #ff9a56, #ff6a6a);
            box-shadow: 0 4px 15px 0 rgba(255, 154, 86, 0.4);
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        .btn-level:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(255, 154, 86, 0.6);
        }
        .btn-level.active {
            background: linear-gradient(45deg, #48cc6c, #2dd65b);
            box-shadow: 0 4px 15px 0 rgba(72, 204, 108, 0.6);
        }
        .choice-button {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        .choice-button:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.6);
            transform: translateY(-1px);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .bounce {
            animation: bounce 0.6s ease-in-out;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        @keyframes celebrationScale {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            40% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .shake-incorrect {
            animation: shakeIncorrect 0.6s ease-in-out;
            background: rgba(248, 113, 113, 0.3) !important;
            border-color: rgba(239, 68, 68, 0.5) !important;
        }
        @keyframes shakeIncorrect {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }

        .correct-answer {
            animation: bounceCorrect 0.6s ease-in-out;
            background: rgba(72, 187, 120, 0.9) !important;
            border-color: rgba(34, 197, 94, 0.8) !important;
        }

        @keyframes bounceCorrect {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1.05); }
            75% { transform: scale(1.1); }
        }
    </style>
</head>
<body>
    
  <!-- Version indicator -->    
    <div class="min-h-screen gradient-bg p-4">
        <div class="max-w-md mx-auto glass-card rounded-2xl shadow-2xl overflow-hidden fade-in">
            <div class="learning-gradient p-5 text-center">
                <div class="version-indicator">Build:  09.07.25-09:23 </div> 
                <h1 class="text-2xl font-bold text-white mb-1" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">üìö N√∫meros en Ingl√©s</h1>
                <p id="subtitle" class="text-white opacity-100 text-sm" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.6);">¬°Aprende los n√∫meros del 0 al 10 con estilo!</p>
            </div>
            
            <!-- Learning Mode -->
            <div id="learn-mode" class="p-5"> 
                <!-- üéØ LEVEL SELECTOR -->
                <div class="text-center mb-6">
                    <div class="level-gradient px-4 py-2 rounded-full text-white font-bold text-sm inline-block mb-4" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
                        üìà Selecciona tu Nivel
                    </div>
                    <div class="flex justify-center space-x-3 mb-4">
                        <button id="beginner-btn" class="btn-level active text-white px-4 py-2 rounded-xl font-bold text-sm">
                            üå± Principiante (0-10)
                        </button>
                        <button id="intermediate-btn" class="btn-level text-white px-4 py-2 rounded-xl font-bold text-sm">
                            üöÄ Intermedio (0-20)
                        </button>
                    </div>
                </div>

                <div class="text-center mb-6">
                    <div id="number-display" class="text-7xl font-bold number-display mb-3 bounce">0</div>
                    <div id="word-display" class="text-3xl font-semibold text-gray-800 mb-2 word-display">zero</div>
                    <div id="pronunciation-display" class="text-lg text-gray-600 mb-5 italic">/siro/</div>
                    <button id="speak-btn" class="btn-success text-white px-6 py-2 rounded-full font-semibold text-base">
                        üîä Escuchar
                    </button>
                    <button id="voice-btn" class="btn-primary text-white px-6 py-2 rounded-full font-semibold text-base ml-3" onclick="switchVoice()">
                  üé≠ Adam
                    </button>
                </div>

                <div class="flex justify-center space-x-6 mb-6">
                    <button id="prev-btn" class="btn-primary text-white px-5 py-2 rounded-xl font-medium text-sm">
                        ‚Üê Anterior
                    </button>
                    <button id="next-btn" class="btn-primary text-white px-5 py-2 rounded-xl font-medium text-sm">
                        Siguiente ‚Üí
                    </button>
                </div>

                <div class="text-center">
                    <button id="start-practice-btn" class="btn-secondary text-white px-8 py-3 rounded-2xl font-bold text-lg">
                        üöÄ Empezar Pr√°ctica
                    </button>
                </div>
            </div>

            <!-- Practice Type Selection -->
            <div id="practice-selection" style="display: none;" class="p-5">
                <div class="text-center mb-6">
                    <div class="practice-gradient px-5 py-2 rounded-full text-white font-bold text-base inline-block mb-3" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
                        üéØ Elige el Modo de Pr√°ctica
                    </div>
                    <div id="level-indicator" class="level-gradient px-4 py-1 rounded-full text-white font-bold text-sm inline-block mb-4" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
                        üå± Nivel Principiante (0-10)
                    </div>
                    <p class="text-lg text-gray-700 font-medium">¬øC√≥mo te gustar√≠a practicar?</p>
                </div>

                <div class="space-y-5 mb-6">
                    <button id="multiple-choice-btn" class="w-full btn-secondary text-white py-4 rounded-2xl font-bold text-lg">
                        üëÜ Opci√≥n M√∫ltiple
                        <div class="text-xs opacity-90 font-normal mt-1">Ver el n√∫mero ‚Üí clic la opci√≥n correcta</div>
                    </button>
                    <button id="audio-only-btn" class="w-full btn-primary text-white py-4 rounded-2xl font-bold text-lg">
                        üéß Solo Audio
                        <div class="text-xs opacity-90 font-normal mt-1">Escuchar el n√∫mero ‚Üí clic la opci√≥n correcta</div>
                    </button>
                </div>

                <div class="text-center">
                    <button id="back-from-selection-btn" class="bg-gray-500 text-white px-6 py-2 rounded-xl hover:bg-gray-600 font-medium text-sm">
                        ‚Üê P√°gina Principal
                    </button>
                </div>
            </div>

            <!-- Practice Mode -->
            <div id="practice-mode" style="display: none;" class="p-5">
                <div class="text-center mb-6">
                    <div class="practice-gradient px-5 py-2 rounded-full text-white font-bold text-base inline-block mb-2" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
                        <span id="practice-mode-label">Modo de Pr√°ctica</span>
                    </div>
                    <div id="practice-level-indicator" class="level-gradient px-4 py-1 rounded-full text-white font-bold text-sm inline-block mb-4" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
                        üå± Nivel Principiante (0-10)
                    </div>
                    
                    <!-- üìä TRACKING DISPLAY -->
                    <div class="flex justify-center space-x-3 mb-4">
                        <div class="bg-green-100 px-3 py-1 rounded-full">
                            <span class="text-green-800 font-bold text-sm">‚úÖ <span id="correct-count">0</span></span>
                        </div>
                        <div class="bg-red-100 px-3 py-1 rounded-full">
                            <span class="text-red-800 font-bold text-sm">‚ùå <span id="incorrect-count">0</span></span>
                        </div>
                        <div class="bg-blue-100 px-3 py-1 rounded-full">
                            <span class="text-blue-800 font-bold text-sm">üìä <span id="total-count">0</span></span>
                        </div>
                        <div id="percentage-pill" class="px-3 py-1 rounded-full">
                            <span id="percentage-text" class="font-bold text-sm">üìà <span id="percentage-count">0</span>%</span>
                        </div>
                    </div>
                    
                    <div id="practice-number" class="text-7xl font-bold number-display mb-3 bounce">0</div>
                   <div id="audio-controls" class="flex justify-center mb-5" style="display: none;">
                       <button id="practice-voice-btn" class="btn-primary text-white px-4 py-1 rounded-full font-semibold text-sm mr-3" onclick="switchVoice()">
                        üé≠ Voice: Adam
                    </button> 
                   <button id="repeat-btn" class="btn-primary text-white px-12 py-4 rounded-full font-bold text-xl">
                üîä Escuchar/Repetir
                    </button>
                      
                    </div> 
                    
                    <!-- Multiple Choice Practice -->
                    <div id="multiple-choice-practice">
                        <div class="grid grid-cols-2 gap-3 mb-5" id="choice-buttons">
                            <!-- Choice buttons will be generated here -->
                        </div>
                    </div>
                    
                    <!-- Audio-Only Practice -->
                    <div id="audio-only-practice" style="display: none;">
                        <div class="grid grid-cols-2 gap-3 mb-5" id="number-choice-buttons">
                            <!-- Number choice buttons will be generated here -->
                        </div>
                    </div>
                    
                    <div id="feedback" class="text-center p-3 rounded-2xl font-bold text-base mb-5 hidden transition-all"></div>
                </div>

                <div class="text-center">
                    <button id="back-to-learn-btn" class="bg-gray-500 text-white px-6 py-2 rounded-xl hover:bg-gray-600 font-medium text-sm">
                        ‚Üê Volver al Aprendizaje
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const numbers = {
            0: { word: 'zero', pronunciation: '/siro/' },
            1: { word: 'one', pronunciation: '/uan/' },
            2: { word: 'two', pronunciation: '/tu/' },
            3: { word: 'three', pronunciation: '/thri/' },
            4: { word: 'four', pronunciation: '/for/' },
            5: { word: 'five', pronunciation: '/faiv/' },
            6: { word: 'six', pronunciation: '/siks/' },
            7: { word: 'seven', pronunciation: '/seven/' },
            8: { word: 'eight', pronunciation: '/eit/' },
            9: { word: 'nine', pronunciation: '/nain/' },
            10: { word: 'ten', pronunciation: '/ten/' },
            11: { word: 'eleven', pronunciation: '/il√©ven/' },
            12: { word: 'twelve', pronunciation: '/tu√©lv/' },
            13: { word: 'thirteen', pronunciation: '/thirt√≠n/' },
            14: { word: 'fourteen', pronunciation: '/fort√≠n/' },
            15: { word: 'fifteen', pronunciation: '/fift√≠n/' },
            16: { word: 'sixteen', pronunciation: '/sikst√≠n/' },
            17: { word: 'seventeen', pronunciation: '/sevent√≠n/' },
            18: { word: 'eighteen', pronunciation: '/eit√≠n/' },
            19: { word: 'nineteen', pronunciation: '/naint√≠n/' },
            20: { word: 'twenty', pronunciation: '/tu√©nti/' }
        };

        let currentNumber = 0;
        let currentVoice = 'adam';
        let currentMode = 'learn';
        let currentLevel = 'beginner'; // 'beginner' (0-10) or 'intermediate' (0-20)
        let practiceNumber = 0;
        let practiceType = 'multiple-choice';
        let practiceAvailableNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
        let practiceUsedNumbers = [];
        
        
        // üéØ SISTEMA DE DOS ESTADOS DEL BOT√ìN
        let hasListenedToCurrentNumber = false;

        // üéØ FUNCIONES DEL SISTEMA DE DOS ESTADOS
function updateAudioButtonState() {
    const button = document.getElementById('repeat-btn');
    if (!button) return;
    
    if (hasListenedToCurrentNumber) {
        // Estado 2: Repetir (Verde)
        button.style.background = 'linear-gradient(45deg, #10b981, #059669)';
        button.style.boxShadow = '0 4px 15px 0 rgba(16, 185, 129, 0.4)';
        button.textContent = 'üîÑ Repetir';
    } else {
        // Estado 1: Escuchar (Azul)
        button.style.background = 'linear-gradient(45deg, #3b82f6, #2563eb)';
        button.style.boxShadow = '0 4px 15px 0 rgba(59, 130, 246, 0.4)';
        button.textContent = 'üîä Escuchar';
    }
}

function resetAudioButtonToListenState() {
    hasListenedToCurrentNumber = false;
    updateAudioButtonState();
}
        
        // üìä TRACKING VARIABLES
        let sessionStats = {
            correct: 0,
            incorrect: 0,
            total: 0
        };

        const numberDisplay = document.getElementById('number-display');
        const wordDisplay = document.getElementById('word-display');
        const pronunciationDisplay = document.getElementById('pronunciation-display');
        const speakBtn = document.getElementById('speak-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const repeatBtn = document.getElementById('repeat-btn'); 
        const subtitle = document.getElementById('subtitle');
        
        const learnMode = document.getElementById('learn-mode');
        const practiceSelection = document.getElementById('practice-selection');
        const practiceMode = document.getElementById('practice-mode');
        
        const beginnerBtn = document.getElementById('beginner-btn');
        const intermediateBtn = document.getElementById('intermediate-btn');
        const levelIndicator = document.getElementById('level-indicator');
        const practiceLevelIndicator = document.getElementById('practice-level-indicator');
        
        const startPracticeBtn = document.getElementById('start-practice-btn');
        const multipleChoiceBtn = document.getElementById('multiple-choice-btn');
        const audioOnlyBtn = document.getElementById('audio-only-btn');
        const backFromSelectionBtn = document.getElementById('back-from-selection-btn');
        
        const backToLearnBtn = document.getElementById('back-to-learn-btn');
        const practiceNumberDisplay = document.getElementById('practice-number');
        const practiceModeLabel = document.getElementById('practice-mode-label');
        const multipleChoicePractice = document.getElementById('multiple-choice-practice');
        const audioOnlyPractice = document.getElementById('audio-only-practice');
        const choiceButtons = document.getElementById('choice-buttons');
        const numberChoiceButtons = document.getElementById('number-choice-buttons');
        const feedback = document.getElementById('feedback');
        
        // üìä TRACKING ELEMENTS
        const correctCountEl = document.getElementById('correct-count');
        const incorrectCountEl = document.getElementById('incorrect-count');
        const totalCountEl = document.getElementById('total-count');
        const percentageCountEl = document.getElementById('percentage-count');
        const percentagePillEl = document.getElementById('percentage-pill');
        const percentageTextEl = document.getElementById('percentage-text');

        // üéØ LEVEL MANAGEMENT
        function getNumberRange() {
            return currentLevel === 'beginner' ? 
                [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] : 
                [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
        }

        function getMaxNumber() {
            return currentLevel === 'beginner' ? 10 : 20;
        }

        function updateLevelDisplay() {
            const isIntermediate = currentLevel === 'intermediate';
            const range = isIntermediate ? '0-20' : '0-10';
            const emoji = isIntermediate ? 'üöÄ' : 'üå±';
            const levelName = isIntermediate ? 'Intermedio' : 'Principiante';
            
            subtitle.textContent = `¬°Aprende los n√∫meros del ${range} con estilo!`;
            levelIndicator.innerHTML = `${emoji} Nivel ${levelName} (${range})`;
            practiceLevelIndicator.innerHTML = `${emoji} Nivel ${levelName} (${range})`;
            
            // Update button active states
            beginnerBtn.classList.toggle('active', currentLevel === 'beginner');
            intermediateBtn.classList.toggle('active', currentLevel === 'intermediate');
            
            // Reset practice numbers for new level
            practiceAvailableNumbers = getNumberRange();
            practiceUsedNumbers = [];
        }

        function switchLevel(level) {
            currentLevel = level;
            updateLevelDisplay();
            
            // Reset to first number when switching levels
            currentNumber = 0;
            updateDisplay();
            
            console.log(`üéØ Switched to ${level} level: ${getNumberRange()}`);
        }

        // üìä TRACKING FUNCTIONS

       function showCorrectAnswer(correctAnswer) {
            console.log('Buscando respuesta correcta:', correctAnswer);
            const choiceButtons = document.querySelectorAll('.choice-button');
            
           if (practiceType === 'multiple-choice') {
                // Modo Opci√≥n M√∫ltiple - destacar bot√≥n correcto
                choiceButtons.forEach(button => {
                    console.log('Bot√≥n encontrado:', button.textContent);
                    if (button.textContent.toLowerCase() === correctAnswer) {
                        button.classList.add('correct-answer');
                        setTimeout(() => {
                            button.classList.remove('correct-answer');
                        }, 2000);
                    }
                });
           } else {
                // Modo Solo Audio - mostrar respuesta en √°rea principal
               const numberDisplay = document.getElementById('practice-number');
                const wordDisplay = document.querySelector('.text-center p'); // Para la palabra
                
                if (numberDisplay && wordDisplay) {
                    // Guardar contenido original
                    const originalNumber = numberDisplay.textContent;
                    const originalWord = wordDisplay.textContent;
                    
                    // Mostrar respuesta correcta
                    wordDisplay.textContent = correctAnswer;
                    wordDisplay.classList.add('correct-answer');
                    
                    setTimeout(() => {
                        // Restaurar contenido original
                        numberDisplay.textContent = originalNumber;
                        wordDisplay.textContent = originalWord;
                        wordDisplay.classList.remove('correct-answer');
                    }, 2000);
                }
            }
        }
        function updateSessionStats(isCorrect) {
            if (isCorrect) {
                sessionStats.correct++;
            } else {
                sessionStats.incorrect++;
            }
            sessionStats.total++;
            
            // Calculate percentage
            const percentage = sessionStats.total > 0 ? 
                Math.round((sessionStats.correct / sessionStats.total) * 100) : 0;
            
            // Update display
            correctCountEl.textContent = sessionStats.correct;
            incorrectCountEl.textContent = sessionStats.incorrect;
            totalCountEl.textContent = sessionStats.total;
            percentageCountEl.textContent = percentage;
            
            // Update percentage color dynamically
            updatePercentageColor(percentage);
            
            console.log(`üìä Stats: ‚úÖ${sessionStats.correct} ‚ùå${sessionStats.incorrect} üìä${sessionStats.total} üìà${percentage}%`);
        }
        
        function updatePercentageColor(percentage) {
            // Remove existing classes
            percentagePillEl.className = 'px-3 py-1 rounded-full';
            
            if (percentage >= 80) {
                // üü¢ Green for 80%+
                percentagePillEl.classList.add('bg-green-100');
                percentageTextEl.className = 'font-bold text-sm text-green-800';
            } else if (percentage >= 60) {
                // üü° Yellow for 60-79%
                percentagePillEl.classList.add('bg-yellow-100');
                percentageTextEl.className = 'font-bold text-sm text-yellow-800';
            } else {
                // üî¥ Red for <60%
                percentagePillEl.classList.add('bg-red-100');
                percentageTextEl.className = 'font-bold text-sm text-red-800';
            }
        }
        
        function resetSessionStats() {
            sessionStats = { correct: 0, incorrect: 0, total: 0 };
            correctCountEl.textContent = '0';
            incorrectCountEl.textContent = '0';
            totalCountEl.textContent = '0';
            percentageCountEl.textContent = '0';
            
            // Reset percentage to neutral color
            percentagePillEl.className = 'px-3 py-1 rounded-full bg-gray-100';
            percentageTextEl.className = 'font-bold text-sm text-gray-600';
            
            console.log('üìä Stats reset for new session');
        }

        // üéâ CELEBRATION ANIMATION SYSTEM
        const celebrationMessages = [
            { text: '¬°Correcto, buen o√≠do!', emoji: 'üéß', colors: 'rgba(34, 197, 94, 0.95)' },
            { text: '¬°Dale pues, buen trabajo!', emoji: 'üí™', colors: 'rgba(59, 130, 246, 0.95)' },
            { text: '¬°Excelente, sigue as√≠!', emoji: '‚≠ê', colors: 'rgba(168, 85, 247, 0.95)' },
            { text: '¬°Qu√© bien, lo tienes!', emoji: 'üéØ', colors: 'rgba(236, 72, 153, 0.95)' },
            { text: '¬°Perfecto, eres un crack!', emoji: 'üèÜ', colors: 'rgba(245, 158, 11, 0.95)' },
            { text: '¬°Incre√≠ble, vas s√∫per bien!', emoji: 'üöÄ', colors: 'rgba(20, 184, 166, 0.95)' },
            { text: '¬°Genial, qu√© inteligente!', emoji: 'üß†', colors: 'rgba(139, 69, 19, 0.95)' },
            { text: '¬°Brutal, lo dominas!', emoji: 'üî•', colors: 'rgba(220, 38, 38, 0.95)' }
        ];

        let availableCelebrations = [...celebrationMessages];
        let usedCelebrations = [];

        function getRandomCelebration() {
            // Si no hay celebraciones disponibles, reiniciar el ciclo
            if (availableCelebrations.length === 0) {
                availableCelebrations = [...celebrationMessages];
                usedCelebrations = [];
                console.log('üéâ Celebraciones reiniciadas - todas disponibles de nuevo');
            }
            
            // Seleccionar una celebraci√≥n aleatoria de las disponibles
            const randomIndex = Math.floor(Math.random() * availableCelebrations.length);
            const selectedCelebration = availableCelebrations[randomIndex];
            
            // Remover de disponibles y agregar a usadas
            availableCelebrations.splice(randomIndex, 1);
            usedCelebrations.push(selectedCelebration);
            
            console.log(`üéä Celebraci√≥n: ${selectedCelebration.text}`);
            console.log(`üé≠ Disponibles: ${availableCelebrations.length}, Usadas: ${usedCelebrations.length}`);
            
            return selectedCelebration;
        }

        function showCelebrationAnimation() {
            // Get unique celebration message
            const celebration = getRandomCelebration();
            
            // Create animation element
            const animationEl = document.createElement('div');
            animationEl.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                background: ${celebration.colors};
                color: white;
                padding: 20px 40px;
                border-radius: 20px;
                font-size: 24px;
                font-weight: bold;
                text-align: center;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                backdrop-filter: blur(10px);
                animation: celebrationScale 1.2s ease-out;
            `;
            
            animationEl.innerHTML = `${celebration.emoji}<br><span style="font-size: 18px;">${celebration.text}</span>`;
            
            document.body.appendChild(animationEl);
            
            // Remove after animation
            setTimeout(() => {
                if (animationEl.parentNode) {
                    animationEl.parentNode.removeChild(animationEl);
                }
            }, 1200);
        }
        
        function showIncorrectAnimation() {
            
            // Aplicar shake a todos los botones de opciones
            const choiceButtons = document.querySelectorAll('.choice-button');
            choiceButtons.forEach(button => {
                button.classList.add('shake-incorrect');
                
                // Remover la clase despu√©s de la animaci√≥n
                setTimeout(() => {
                    button.classList.remove('shake-incorrect');
                }, 600);
            });
        }

        function generateRandomNumber() {
            // Si no hay n√∫meros disponibles, reiniciar el ciclo
            if (practiceAvailableNumbers.length === 0) {
                practiceAvailableNumbers = getNumberRange();
                practiceUsedNumbers = [];
                console.log('üîÑ Ciclo reiniciado - todos los n√∫meros disponibles de nuevo');
            }
            
            // Seleccionar un n√∫mero aleatorio de los disponibles
            const randomIndex = Math.floor(Math.random() * practiceAvailableNumbers.length);
            const selectedNumber = practiceAvailableNumbers[randomIndex];
            

        function generateWrongOptions(correctAnswer) {
    // üéØ L√ìGICA MEJORADA: Rangos inteligentes para nivel intermedio
    let availableNumbers;
    
    if (currentLevel === 'beginner') {
        // Principiante: usar todos los n√∫meros 0-10
        availableNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    } else {
        // Intermedio: rangos l√≥gicos
        if (correctAnswer <= 10) {
            availableNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
        } else {
            availableNumbers = [11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
        }
    }
    
    const wrongOptions = availableNumbers
        .filter(num => num !== correctAnswer)
        .sort(() => Math.random() - 0.5)
        .slice(0, 3);
    return [...wrongOptions, correctAnswer].sort(() => Math.random() - 0.5);
}

    function generateWrongNumberOptions(correctAnswer) {
    // üéØ L√ìGICA MEJORADA: Rangos inteligentes para nivel intermedio
    let availableNumbers;
    
    if (currentLevel === 'beginner') {
        // Principiante: usar todos los n√∫meros 0-10
        availableNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    } else {
        // Intermedio: rangos l√≥gicos
        if (correctAnswer <= 10) {
            availableNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
        } else {
            availableNumbers = [11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
        }
    }
    
    const wrongOptions = availableNumbers
        .filter(num => num !== correctAnswer)
        .sort(() => Math.random() - 0.5)
        .slice(0, 3);
    return [...wrongOptions, correctAnswer].sort(() => Math.random() - 0.5);
}

        function createNumberChoiceButtons() {
            const options = generateWrongNumberOptions(practiceNumber);
            numberChoiceButtons.innerHTML = '';
            
            options.forEach((num) => {
                const button = document.createElement('button');
                button.textContent = num;
                button.className = 'choice-button py-5 rounded-2xl font-bold text-2xl transition-all';
                button.addEventListener('click', () => handleAudioOnlyAnswer(num));
                numberChoiceButtons.appendChild(button);
            });
        }

        function createMultipleChoiceButtons() {
            const options = generateWrongOptions(practiceNumber);
            choiceButtons.innerHTML = '';
            
            options.forEach((num) => {
                const button = document.createElement('button');
                button.textContent = numbers[num].word;
                button.className = 'choice-button py-3 rounded-2xl font-bold text-base transition-all';
                button.addEventListener('click', () => handleMultipleChoiceAnswer(numbers[num].word));
                choiceButtons.appendChild(button);
            });
        }

        function createAudioChoiceButtons() {
            const options = generateWrongNumberOptions(practiceNumber);
            choiceButtons.innerHTML = '';
            
            options.forEach((num) => {
                const button = document.createElement('button');
                button.textContent = num;
                button.className = 'choice-button py-3 rounded-2xl font-bold text-base transition-all';
                button.addEventListener('click', () => handleAudioOnlyAnswer(num));
                choiceButtons.appendChild(button);
            });
        }
        
        // MP3 AUDIO SYSTEM - Adam & Rachel voices
        // Audio unlock para m√≥viles
        let audioUnlocked = false;

        function unlockAudio() {
            if (!audioUnlocked) {
                const audio = new Audio();
                audio.play().then(() => {
                    audioUnlocked = true;
                }).catch(() => {});
            }
        }

        // Unlock audio en primera interacci√≥n
        document.addEventListener('click', unlockAudio, { once: true });
        document.addEventListener('touchstart', unlockAudio, { once: true });       

        function speakNumber(number) {
            const audioFile = `audio/${currentVoice}/${currentVoice}_${number}.mp3`;
            
            const audio = new Audio(audioFile);
            unlockAudio(); // Asegurar unlock
            audio.play().catch(error => {
                console.error('Error playing audio:', error);
            });
        }

        // Voice switching function
        function switchVoice() {
            currentVoice = currentVoice === 'adam' ? 'rachel' : 'adam';
            const voiceBtn = document.getElementById('voice-btn');
            if (voiceBtn) {
                voiceBtn.textContent = `üé≠ ${currentVoice.charAt(0).toUpperCase() + currentVoice.slice(1)}`;
            }
            console.log(`Voice switched to: ${currentVoice}`);

            const practiceVoiceBtn = document.getElementById('practice-voice-btn');
            if (practiceVoiceBtn) {
                practiceVoiceBtn.textContent = `üé≠ ${currentVoice.charAt(0).toUpperCase() + currentVoice.slice(1)}`;
            }
        }

        function showFeedback(message, isCorrect) {
            feedback.textContent = message;
            feedback.className = `text-center p-4 rounded-2xl font-bold text-lg mb-6 transition-all ${
                isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
            }`;
            feedback.classList.remove('hidden');
        }

        function hideFeedback() {
            feedback.classList.add('hidden');
        }

        function updateDisplay() {
            numberDisplay.textContent = currentNumber;
            wordDisplay.textContent = numbers[currentNumber].word;
            pronunciationDisplay.textContent = numbers[currentNumber].pronunciation;
            
            numberDisplay.classList.remove('bounce');
            setTimeout(() => numberDisplay.classList.add('bounce'), 10);
            
            const maxNum = getMaxNumber();
            prevBtn.disabled = currentNumber === 0;
            nextBtn.disabled = currentNumber === maxNum;
            
            if (prevBtn.disabled) {
                prevBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                prevBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
            
            if (nextBtn.disabled) {
                nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        function showPracticeSelection() {
            currentMode = 'selection';
            learnMode.style.display = 'none';
            practiceSelection.style.display = 'block';
            practiceMode.style.display = 'none';
        }

        function switchToLearnMode() {
            currentMode = 'learn';
            learnMode.style.display = 'block';
            practiceSelection.style.display = 'none';
            practiceMode.style.display = 'none';
            hideFeedback();
        }

        function configurePracticeInterface(questionType) {
            if (questionType === 'multiple-choice') {
                // Mostrar interfaz de opci√≥n m√∫ltiple
                multipleChoicePractice.style.display = 'block';
                audioOnlyPractice.style.display = 'none';
                
               // Mostrar botones de audio tambi√©n en m√∫ltiple
                document.getElementById('audio-controls').style.display = 'flex';

                // Mostrar botones de audio tambi√©n en m√∫ltiple
                document.getElementById('audio-controls').style.display = 'flex';

                // üéØ Actualizar estado del bot√≥n al mostrar controles
                updateAudioButtonState();
                
                // Mostrar el n√∫mero y cambiar instrucci√≥n
                practiceNumberDisplay.style.display = 'block';
                
                
                // Crear botones de opci√≥n m√∫ltiple
                createMultipleChoiceButtons();
                } else if (questionType === 'audio-only') {
        // Mostrar interfaz de solo audio usando la misma interfaz m√∫ltiple
        multipleChoicePractice.style.display = 'block';
        audioOnlyPractice.style.display = 'none';
        
        // Mostrar botones de audio
        document.getElementById('audio-controls').style.display = 'flex';
        
        // Ocultar el n√∫mero y cambiar instrucci√≥n
        practiceNumberDisplay.style.display = 'none';
        
        // Crear botones de n√∫meros en la misma interfaz
        createAudioChoiceButtons();
                
                
                // Ocultar el n√∫mero y cambiar instrucci√≥n
                practiceNumberDisplay.style.display = 'none';
               // document.querySelector('#practice-mode p').textContent = 'Escucha y elige el n√∫mero correcto:';
                
                // Crear botones de n√∫meros en la misma interfaz
                createAudioChoiceButtons();
                       
               
            }
        }

        function switchToPracticeMode() {
            currentMode = 'practice';
            learnMode.style.display = 'none';
            practiceSelection.style.display = 'none';
            practiceMode.style.display = 'block';
            
            // üìä Reset stats for new practice session
            resetSessionStats();
            
            // Asegurar que el sistema anti-repetici√≥n est√© listo con el nivel actual
            practiceAvailableNumbers = getNumberRange();
            practiceUsedNumbers = [];
            
            practiceNumber = generateRandomNumber();
            practiceNumberDisplay.textContent = practiceNumber;

            // üéØ Resetear bot√≥n a Estado 1 para nueva sesi√≥n
            resetAudioButtonToListenState();
            
            // Configurar interfaz seg√∫n el tipo de pr√°ctica
            configurePracticeInterface(practiceType);
            hideFeedback();
            
            // Auto-play inicial solo para Solo Audio
            if (practiceType === 'audio-only') {
            setTimeout(() => {
            speakNumber(practiceNumber);
            }, 500);
    }
        }

        function handleMultipleChoiceAnswer(selectedWord) {
            const correctAnswer = numbers[practiceNumber].word.toLowerCase();
            
            if (selectedWord.toLowerCase() === correctAnswer) {
                updateSessionStats(true); // üìä Track correct answer
                showCelebrationAnimation(); // üéâ Show celebration!
                
            } else {
                updateSessionStats(false); // üìä Track incorrect answer
                showIncorrectAnimation(); // üéØ Show shake animation for incorrect answer
                showCorrectAnswer(correctAnswer);

            
            }
            
            // ‚è∞ SIEMPRE continuar despu√©s de 2 segundos
            setTimeout(() => {
                practiceNumber = generateRandomNumber();
                practiceNumberDisplay.textContent = practiceNumber;
               configurePracticeInterface(practiceType);
                resetAudioButtonToListenState(); // üéØ Resetear bot√≥n a Estado 1
                hideFeedback();
               }, 2000);
      }

        function handleAudioOnlyAnswer(selectedNumber) {
            if (selectedNumber === practiceNumber) {
                updateSessionStats(true); // üìä Track correct answer
                showCelebrationAnimation(); // üéâ Show celebration!
            } else {
                updateSessionStats(false); // üìä Track incorrect answer
                showIncorrectAnimation(); // üéØ Show shake animation for incorrect answer
                showCorrectAnswer(numbers[practiceNumber].word.toLowerCase());
            }

            
    setTimeout(() => {
        practiceNumber = generateRandomNumber();
        practiceNumberDisplay.textContent = practiceNumber;
        resetAudioButtonToListenState(); // üéØ Resetear bot√≥n a Estado 1
        configurePracticeInterface(practiceType);
        hideFeedback();
    }, 2000);
}
            
          // ‚è∞ SIEMPRE continuar despu√©s de 1.5 segundos
setTimeout(() => {
    practiceNumber = generateRandomNumber();
    practiceNumberDisplay.textContent = practiceNumber;
    resetAudioButtonToListenState(); // üéØ Resetear bot√≥n a Estado 1
    configurePracticeInterface(practiceType);
    hideFeedback();
}, 1500);

       function playPracticeNumberAudio() {
    unlockAudio(); // Asegurar unlock antes de audio autom√°tico
    setTimeout(() => {
        speakNumber(practiceNumber);
    }, 150); // Peque√±o delay para Chrome mobile autoplay
}

        function startMultipleChoicePractice() {
            practiceType = 'multiple-choice';
            practiceModeLabel.textContent = 'üëÜ Opci√≥n M√∫ltiple';
            switchToPracticeMode();
        }

        function startAudioOnlyPractice() {
            practiceType = 'audio-only';
            practiceModeLabel.textContent = 'üéß Pr√°ctica Solo Audio';
            switchToPracticeMode();
        }

        // Event Listeners
        prevBtn.addEventListener('click', () => {
            if (currentNumber > 0) {
                currentNumber--;
                updateDisplay();
            }
        });

        nextBtn.addEventListener('click', () => {
            const maxNum = getMaxNumber();
            if (currentNumber < maxNum) {
                currentNumber++;
                updateDisplay();
            }
        });

        speakBtn.addEventListener('click', () => {
            // Cambiar a gris
            speakBtn.style.background = '#9CA3AF';
            speakBtn.style.transform = 'scale(0.95)';
            
            speakNumber(currentNumber);
            
            // Volver al color original despu√©s de 2 segundos
            setTimeout(() => {
                speakBtn.style.background = '';
                speakBtn.style.transform = '';
            }, 2000);
        });

        // Level selection event listeners
        beginnerBtn.addEventListener('click', () => switchLevel('beginner'));
        intermediateBtn.addEventListener('click', () => switchLevel('intermediate'));

        startPracticeBtn.addEventListener('click', showPracticeSelection);
        multipleChoiceBtn.addEventListener('click', startMultipleChoicePractice);
        audioOnlyBtn.addEventListener('click', startAudioOnlyPractice);
        backFromSelectionBtn.addEventListener('click', switchToLearnMode);
        backToLearnBtn.addEventListener('click', switchToLearnMode);

        
        if (repeatBtn) {
    repeatBtn.addEventListener('click', () => {
        console.log('üîÑ Bot√≥n de audio clickeado!');
        
        // üéØ Cambiar a Estado 2 despu√©s del primer click
        if (!hasListenedToCurrentNumber) {
            hasListenedToCurrentNumber = true;
            updateAudioButtonState();
        }
        
        speakNumber(practiceNumber);
    });
}


 

        // Inicializar la app
        updateLevelDisplay();
        updateDisplay();
     

</body>
</html>
